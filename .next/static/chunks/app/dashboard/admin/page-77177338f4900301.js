(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{41269:(e,s,t)=>{Promise.resolve().then(t.bind(t,67077))},49939:(e,s,t)=>{"use strict";t.d(s,{default:()=>l});var a=t(11291),r=t(97451),i=t(95876),n=t(90718);function l(){let[e,s]=(0,r.useState)(!1),t=(0,i.useRouter)(),l=async()=>{s(!0);try{await fetch("/api/logout",{method:"POST"}),t.replace("/login")}finally{s(!1)}};return(0,a.jsx)(n.$,{variant:"ghost",onClick:l,disabled:e,children:e?"Saliendo…":"Cerrar sesi\xf3n"})}},57277:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(92608).A)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])},67077:(e,s,t)=>{"use strict";t.d(s,{AdminDashboard:()=>F});var a=t(11291),r=t(97451),i=t(64787),n=t.n(i),l=t(82596),c=t(90718),d=t(93293),o=t(55448),m=t(13245),x=t(49716),u=t(11103),h=t(49043),f=t(52984),g=t(96131),p=t(83229),y=t(84178),j=t(38275),v=(0,f.gu)({chartName:"BarChart",GraphicalChild:g.y,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:p.W},{axisType:"yAxis",AxisComp:y.h}],formatAxisMap:j.pr}),N=t(44910),b=t(90964),w=t(55872),C=t(21410),k=t(11762),A=t(69719),B=t(90465),D=t(57277),M=t(26181),R=t(68671);function T(e){let{stats:s}=e,t=[{title:"Casos totales",value:s.totalCases,description:"".concat(s.activeCases," activos"),icon:D.A,tone:"text-lexser-blue-600 bg-lexser-blue-100"},{title:"Clientes",value:s.totalClients,description:"Registrados en la firma",icon:M.A,tone:"text-emerald-600 bg-emerald-100"},{title:"Documentos",value:s.totalDocuments,description:"".concat(s.totalNotes," notas"),icon:R.A,tone:"text-violet-600 bg-violet-100"},{title:"Pendientes",value:s.pendingRequests,description:"".concat(s.overdueStages," vencidos"),icon:k.A,tone:"text-amber-600 bg-amber-100"}];return(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4",children:t.map(e=>{let{title:s,value:t,description:r,icon:i,tone:n}=e;return(0,a.jsxs)(l.Zp,{className:"border-lexser-gray-100",children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-sm font-medium text-muted-foreground",children:s}),(0,a.jsx)("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-full ".concat(n),children:(0,a.jsx)(i,{className:"h-4 w-4"})})]}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-lexser-gray-900",children:t}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]})]},s)})})}var Z=t(49939);function F(e){let{profile:s,data:t}=e,[i,f]=(0,r.useState)("6m"),j=t.stats;return j?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(A.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Dashboard Administrativo"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"LEXSER"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"hidden sm:block text-right",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:s.nombre}),(0,a.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:s.role.replace("_"," ")})]}),(0,a.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-medium",style:{backgroundColor:(0,d.qA)(s.nombre)},children:(0,d.IM)(s.nombre)}),(0,a.jsx)(c.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsx)(n(),{href:"/dashboard/admin/users",children:"Gestionar usuarios"})}),(0,a.jsx)(Z.default,{})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)(T,{stats:j}),(0,a.jsx)("div",{className:"mt-8"}),(j.overdueStages>0||t.upcomingDeadlines.length>0)&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[j.overdueStages>0&&(0,a.jsxs)(l.Zp,{className:"border-red-200",children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(k.A,{className:"h-5 w-5"}),"Etapas Vencidas (",j.overdueStages,")"]})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsxs)("p",{className:"text-sm text-red-600",children:["Hay ",j.overdueStages," etapas que han pasado su fecha programada y requieren atenci\xf3n inmediata."]}),(0,a.jsx)(c.$,{size:"sm",className:"mt-3",variant:"outline",children:"Ver Etapas Vencidas"})]})]}),t.upcomingDeadlines.length>0&&(0,a.jsxs)(l.Zp,{className:"border-yellow-200",children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2 text-yellow-700",children:[(0,a.jsx)(B.A,{className:"h-5 w-5"}),"Pr\xf3ximos Vencimientos"]})}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"space-y-2",children:t.upcomingDeadlines.slice(0,3).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"truncate",children:e.etapa}),(0,a.jsx)("span",{className:"text-gray-500",children:(0,d.Yq)(e.fecha_programada)})]},s))}),t.upcomingDeadlines.length>3&&(0,a.jsxs)(c.$,{size:"sm",className:"mt-3",variant:"outline",children:["Ver Todos (",t.upcomingDeadlines.length,")"]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Distribuci\xf3n de Casos por Estado"})}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)(o.u,{width:"100%",height:300,children:(0,a.jsxs)(m.r,{children:[(0,a.jsx)(x.F,{data:t.casesByStatus,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{status:s,percentage:t}=e;return"".concat(s," (").concat(t,"%)")},outerRadius:80,fill:"#8884d8",dataKey:"count",children:t.casesByStatus.map((e,s)=>(0,a.jsx)(u.f,{fill:{activo:"#10B981",suspendido:"#F59E0B",archivado:"#6B7280",terminado:"#3B82F6"}[e.status]||"#6B7280"},"cell-".concat(s)))}),(0,a.jsx)(h.m,{})]})})})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Casos por Materia Legal"})}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)(o.u,{width:"100%",height:300,children:(0,a.jsxs)(v,{data:t.casesByMateria,children:[(0,a.jsx)(N.d,{strokeDasharray:"3 3"}),(0,a.jsx)(p.W,{dataKey:"materia"}),(0,a.jsx)(y.h,{}),(0,a.jsx)(h.m,{}),(0,a.jsx)(g.y,{dataKey:"count",fill:"#3B82F6"})]})})})]})]}),(0,a.jsxs)(l.Zp,{className:"mb-8",children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.ZB,{children:"Tendencias Mensuales"}),(0,a.jsx)("div",{className:"flex space-x-2",children:["3m","6m","12m"].map(e=>(0,a.jsx)(c.$,{size:"sm",variant:i===e?"default":"outline",onClick:()=>f(e),children:"3m"===e?"3 meses":"6m"===e?"6 meses":"12 meses"},e))})]})}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)(o.u,{width:"100%",height:400,children:(0,a.jsxs)(b.b,{data:t.monthlyStats.slice(-("3m"===i?3:"6m"===i?6:12)),children:[(0,a.jsx)(N.d,{strokeDasharray:"3 3"}),(0,a.jsx)(p.W,{dataKey:"month"}),(0,a.jsx)(y.h,{yAxisId:"left"}),(0,a.jsx)(y.h,{yAxisId:"right",orientation:"right"}),(0,a.jsx)(h.m,{formatter:(e,s)=>["revenue"===s?(0,d.vv)(e):e,"newCases"===s?"Casos Nuevos":"completedCases"===s?"Casos Completados":"Ingresos"]}),(0,a.jsx)(w.s,{}),(0,a.jsx)(g.y,{yAxisId:"left",dataKey:"newCases",fill:"#3B82F6",name:"Casos Nuevos"}),(0,a.jsx)(g.y,{yAxisId:"left",dataKey:"completedCases",fill:"#10B981",name:"Casos Completados"}),(0,a.jsx)(C.N,{yAxisId:"right",type:"monotone",dataKey:"revenue",stroke:"#F59E0B",strokeWidth:2,name:"Ingresos"})]})})})]}),"admin_firma"===s.role&&t.abogadoWorkload.length>0&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsx)(l.ZB,{children:"Carga de Trabajo por Abogado"})}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:t.abogadoWorkload.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-medium",style:{backgroundColor:(0,d.qA)(e.nombre)},children:(0,d.IM)(e.nombre)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.nombre}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.activeCases," casos activos • ",e.completedCases," completados"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:(0,d.vv)(e.totalValue)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Promedio: ",(0,d.vv)(e.avgCaseValue)]})]})]},e.abogado_id))})})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(k.A,{className:"h-12 w-12 mx-auto mb-4 text-red-500"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error al cargar datos"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No se pudieron cargar las estad\xedsticas del dashboard"})]})})}},68671:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(92608).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},69719:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(92608).A)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]])},82596:(e,s,t)=>{"use strict";t.d(s,{Wu:()=>d,ZB:()=>c,Zp:()=>n,aR:()=>l});var a=t(11291),r=t(97451),i=t(93293);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});n.displayName="Card";let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...r})}).displayName="CardDescription";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",t),...r})});d.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},90465:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(92608).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},90718:(e,s,t)=>{"use strict";t.d(s,{$:()=>d});var a=t(11291),r=t(97451),i=t(26809),n=t(11263),l=t(93293);let c=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:n,asChild:d=!1,...o}=e,m=d?i.DX:"button";return(0,a.jsx)(m,{className:(0,l.cn)(c({variant:r,size:n,className:t})),ref:s,...o})});d.displayName="Button"},93293:(e,s,t)=>{"use strict";t.d(s,{IM:()=>h,Yq:()=>d,cn:()=>l,fw:()=>x,kz:()=>o,m7:()=>f,nr:()=>u,qA:()=>p,r6:()=>m,v7:()=>g,vv:()=>c});var a=t(41111),r=t(98358);function i(e){return null!=e?e:""}function n(e){if(!e)return new Date("Invalid Date");let s="string"==typeof e?new Date(e):e;return isNaN(s.getTime())?new Date("Invalid Date"):s}function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}function c(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(e)}function d(e){let s=n(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"long",day:"numeric"}).format(s)}function o(e){let s=n(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit"}).format(s)}function m(e){let s=n(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(s)}function x(e){let s=n(null!=e?e:null);if(isNaN(s.getTime()))return"Fecha inv\xe1lida";let t=(Date.now()-s.getTime())/1e3;return t<60?"hace unos segundos":t<3600?"hace ".concat(Math.floor(t/60)," minutos"):t<86400?"hace ".concat(Math.floor(t/3600)," horas"):t<2592e3?"hace ".concat(Math.floor(t/86400)," d\xedas"):t<31104e3?"hace ".concat(Math.floor(t/2592e3)," meses"):"hace ".concat(Math.floor(t/31104e3)," a\xf1os")}function u(e){let s=i(e).replace(/[^0-9kK]/g,"");if(s.length<8)return s;let t=s.slice(0,-1),a=s.slice(-1),r=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return"".concat(r,"-").concat(a)}function h(e){let s=i(e).trim();return s?s.split(/\s+/).map(e=>e[0]).join("").toUpperCase().slice(0,2):""}function f(e){let s=n(null!=e?e:null);if(isNaN(s.getTime()))return!1;let t=new Date;t.setHours(0,0,0,0);let a=new Date(s);return a.setHours(0,0,0,0),a<t}function g(e){let s="number"!=typeof e||isNaN(e)?0:e;if(s<=0)return"0 Bytes";let t=["Bytes","KB","MB","GB"],a=Math.min(Math.floor(Math.log(s)/Math.log(1024)),t.length-1),r=(s/Math.pow(1024,a)).toFixed(2);return"".concat(r," ").concat(t[a])}function p(e){let s=i(e),t=0;for(let e=0;e<s.length;e++)t=s.charCodeAt(e)+((t<<5)-t);let a=(t%360+360)%360;return"hsl(".concat(a,", 70%, 50%)")}},95876:(e,s,t)=>{"use strict";var a=t(91732);t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})}},e=>{e.O(0,[936,787,379,193,55,358],()=>e(e.s=41269)),_N_E=e.O()}]);