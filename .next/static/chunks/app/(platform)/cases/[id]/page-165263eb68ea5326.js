(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71],{25126:(e,s,a)=>{Promise.resolve().then(a.t.bind(a,64787,23)),Promise.resolve().then(a.bind(a,93670))},26181:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(92608).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},93670:(e,s,a)=>{"use strict";a.d(s,{CaseDetailView:()=>I});var l=a(11291),t=a(97451),i=a(95876),r=a(82596),n=a(9983),c=a(90718),d=a(54997),o=a(14007),m=a(8179),x=a(25711),h=a(68668),p=a(93293),u=a(69719),b=a(96843),j=a(68671),g=a(64501),N=a(26181),f=a(92608);let v=(0,f.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var y=a(62490);let w=(0,f.A)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var _=a(27416),A=a(77297),C=a(89740),k=a(90465),M=a(87917),q=a(77230);function I(e){var s,a,f,I,P,R,E;let{case:D,profile:S,messages:U}=e,[F,T]=(0,t.useState)("overview"),z=(0,i.useRouter)(),L="admin_firma"===S.role||"abogado"===S.role&&(null==(s=D.abogado_responsable)?void 0:s.id)===S.id,V="cliente"!==S.role,Z="cliente"!==S.role,$="cliente"!==S.role,H=e=>null==e||Number.isNaN(e)?"â€”":"".concat(new Intl.NumberFormat("es-CL",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)," UF"),O=null!=(a=D.honorario_total_uf)?a:null,B=null!=(f=D.honorario_pagado_uf)?f:0,G=null!==O?Math.max(O-B,0):null,W=[{id:"overview",label:"Resumen",icon:u.A},{id:"timeline",label:"Timeline",icon:b.A},{id:"documents",label:"Documentos",icon:j.A},{id:"notes",label:"Notas",icon:g.A},{id:"messages",label:"Mensajes",icon:g.A},{id:"requests",label:"Solicitudes",icon:g.A},...L?[{id:"clients",label:"Clientes",icon:N.A}]:[]];return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)(c.$,{variant:"ghost",size:"sm",onClick:()=>z.back(),children:[(0,l.jsx)(v,{className:"h-4 w-4 mr-2"}),"Volver"]}),(0,l.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,l.jsx)(u.A,{className:"h-6 w-6 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Detalle del Caso"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Xel Chile"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[L&&(0,l.jsxs)(c.$,{size:"sm",variant:"outline",children:[(0,l.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Editar Caso"]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:S.nombre}),(0,l.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:S.role.replace("_"," ")})]}),(0,l.jsx)("div",{className:"h-8 w-8 rounded-full flex items-center justify-center text-white font-medium text-sm",style:{backgroundColor:(0,p.qA)(S.nombre)},children:(0,p.IM)(S.nombre)})]})]})})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsx)(r.Zp,{className:"mb-8",children:(0,l.jsxs)(r.Wu,{className:"pt-6",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:D.caratulado}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[D.numero_causa&&(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"Causa: ",D.numero_causa]}),D.materia&&(0,l.jsxs)("span",{children:["Materia: ",D.materia]}),D.tribunal&&(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(w,{className:"h-4 w-4 mr-1"}),D.tribunal]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[(R=D.estado||"activo",(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({activo:"bg-green-100 text-green-800",suspendido:"bg-yellow-100 text-yellow-800",archivado:"bg-gray-100 text-gray-800",terminado:"bg-blue-100 text-blue-800"}[R]||"bg-gray-100 text-gray-800"),children:R.charAt(0).toUpperCase()+R.slice(1)})),D.prioridad&&(E=D.prioridad,(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({baja:"bg-gray-100 text-gray-800",media:"bg-blue-100 text-blue-800",alta:"bg-orange-100 text-orange-800",urgente:"bg-red-100 text-red-800"}[E]||"bg-gray-100 text-gray-800"),children:E.charAt(0).toUpperCase()+E.slice(1)})),D.etapa_actual&&(0,l.jsx)(n.E,{variant:"outline",children:D.etapa_actual})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[D.abogado_responsable&&(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,l.jsxs)("h3",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[(0,l.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"Abogado Responsable"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsx)("p",{className:"font-medium text-blue-800",children:D.abogado_responsable.nombre}),D.abogado_responsable.telefono&&(0,l.jsxs)("p",{className:"flex items-center text-blue-700",children:[(0,l.jsx)(A.A,{className:"h-3 w-3 mr-1"}),D.abogado_responsable.telefono]}),D.abogado_responsable.email&&(0,l.jsxs)("p",{className:"flex items-center text-blue-700",children:[(0,l.jsx)(C.A,{className:"h-3 w-3 mr-1"}),D.abogado_responsable.email]})]})]}),D.nombre_cliente&&(0,l.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,l.jsxs)("h3",{className:"font-medium text-green-900 mb-2 flex items-center",children:[(0,l.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"Cliente"]}),(0,l.jsx)("p",{className:"text-sm font-medium text-green-800",children:D.nombre_cliente}),D.rut_cliente&&(0,l.jsxs)("p",{className:"text-sm text-green-700",children:["RUT: ",D.rut_cliente]})]}),(0,l.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[(0,l.jsxs)("h3",{className:"font-medium text-purple-900 mb-2 flex items-center",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Fechas"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-purple-700",children:[D.fecha_inicio&&(0,l.jsxs)("p",{children:["Inicio: ",(0,p.Yq)(D.fecha_inicio)]}),D.fecha_termino&&(0,l.jsxs)("p",{children:["T\xe9rmino: ",(0,p.Yq)(D.fecha_termino)]})]})]}),D.valor_estimado&&(0,l.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4",children:[(0,l.jsxs)("h3",{className:"font-medium text-yellow-900 mb-2 flex items-center",children:[(0,l.jsx)(M.A,{className:"h-4 w-4 mr-2"}),"Valor Estimado"]}),(0,l.jsx)("p",{className:"text-lg font-bold text-yellow-800",children:(0,p.vv)(D.valor_estimado)})]}),(null!==O||D.tarifa_referencia)&&(0,l.jsxs)("div",{className:"bg-indigo-50 rounded-lg p-4",children:[(0,l.jsxs)("h3",{className:"font-medium text-indigo-900 mb-2 flex items-center",children:[(0,l.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"Honorarios"]}),(0,l.jsxs)("div",{className:"space-y-1 text-sm text-indigo-800",children:[D.modalidad_cobro&&(0,l.jsx)("p",{className:"uppercase text-xs tracking-wide text-indigo-600",children:D.modalidad_cobro}),null!==O&&(0,l.jsxs)("p",{className:"font-semibold",children:["Total: ",H(O)]}),null!==O&&(0,l.jsxs)("p",{children:["Pagado: ",H(B)]}),null!==G&&(0,l.jsxs)("p",{children:["Pendiente: ",H(G)]}),D.honorario_variable_porcentaje&&(0,l.jsxs)("p",{children:["Variable: ",D.honorario_variable_porcentaje,"%",D.honorario_variable_base?" (".concat(D.honorario_variable_base,")"):""]}),D.tarifa_referencia&&(0,l.jsxs)("p",{className:"text-xs text-indigo-600",children:["Tarifa: ",D.tarifa_referencia]}),D.honorario_notas&&(0,l.jsx)("p",{className:"text-xs text-indigo-700 whitespace-pre-wrap",children:D.honorario_notas})]})]})]}),D.contraparte&&(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Contraparte"}),(0,l.jsx)("p",{className:"text-gray-700",children:D.contraparte})]}),D.observaciones&&(0,l.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Observaciones"}),(0,l.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:D.observaciones})]})]})}),(0,l.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,l.jsx)("nav",{className:"-mb-px flex space-x-8",children:W.map(e=>{let s=e.icon;return(0,l.jsxs)("button",{onClick:()=>T(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(F===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,l.jsx)(s,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:e.label})]},e.id)})})}),(0,l.jsxs)("div",{children:["overview"===F&&(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsx)(m.S,{caseId:D.id,caseMateria:null!=(I=D.materia)?I:"General",canManageStages:L,showPrivateStages:$})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(o.$,{caseId:D.id,canUpload:L,canEdit:L,canDelete:L,showPrivateDocuments:$}),(0,l.jsx)(x.L,{caseId:D.id,canCreateRequests:!0,canRespondRequests:Z,showPrivateRequests:$})]})]}),"timeline"===F&&(0,l.jsx)(m.S,{caseId:D.id,caseMateria:null!=(P=D.materia)?P:"General",canManageStages:L,showPrivateStages:$}),"documents"===F&&(0,l.jsx)(o.$,{caseId:D.id,canUpload:L,canEdit:L,canDelete:L,showPrivateDocuments:$}),"notes"===F&&(0,l.jsx)(d._,{caseId:D.id,canCreateNotes:V,canEditNotes:V,showPrivateNotes:$}),"messages"===F&&(0,l.jsx)(h.B,{caseId:D.id,initialMessages:U,currentProfileId:S.id,allowSend:"cliente"!==S.role}),"requests"===F&&(0,l.jsx)(x.L,{caseId:D.id,canCreateRequests:!0,canRespondRequests:Z,showPrivateRequests:$}),"clients"===F&&L&&(0,l.jsx)("div",{className:"space-y-6",children:D.clients&&D.clients.length>0&&(0,l.jsxs)(r.Zp,{children:[(0,l.jsx)(r.aR,{children:(0,l.jsxs)(r.ZB,{className:"flex items-center gap-2",children:[(0,l.jsx)(N.A,{className:"h-5 w-5"}),"Clientes Asociados (",D.clients.length,")"]})}),(0,l.jsx)(r.Wu,{children:(0,l.jsx)("div",{className:"space-y-3",children:D.clients.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-medium",style:{backgroundColor:(0,p.qA)(e.nombre)},children:(0,p.IM)(e.nombre)}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-gray-900",children:e.nombre}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(C.A,{className:"h-3 w-3 mr-1"}),e.email]}),e.telefono&&(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(A.A,{className:"h-3 w-3 mr-1"}),e.telefono]})]})]})]}),(0,l.jsx)(n.E,{variant:"outline",children:"Cliente"})]},e.id))})})]})})]})]})]})}}},e=>{e.O(0,[936,787,577,4,182,193,55,358],()=>e(e.s=25126)),_N_E=e.O()}]);