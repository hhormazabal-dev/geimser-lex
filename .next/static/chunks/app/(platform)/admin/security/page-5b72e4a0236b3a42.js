(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{9983:(e,s,t)=>{"use strict";t.d(s,{E:()=>n});var r=t(11291);t(97451);var a=t(11263),i=t(93293);let l=(0,a.F)("inline-flex items-center gap-1 rounded-full border px-3 py-0.5 text-xs font-medium tracking-tight transition-all focus:outline-none focus:ring-2 focus:ring-offset-2",{variants:{variant:{default:"border-white/30 bg-white/70 text-foreground/80 shadow-sm backdrop-blur-md",secondary:"border-white/20 bg-white/30 text-foreground/70",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/90",outline:"border-white/40 text-foreground/70",success:"border-transparent bg-emerald-500/15 text-emerald-500",warning:"border-transparent bg-amber-400/20 text-amber-600",info:"border-transparent bg-sky-500/15 text-sky-500"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)(l({variant:t}),s),...a})}},23403:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},59030:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{callServer:function(){return r.callServer},createServerReference:function(){return i.createServerReference},findSourceMapURL:function(){return a.findSourceMapURL}});let r=t(87233),a=t(89721),i=t(54661)},62261:(e,s,t)=>{Promise.resolve().then(t.bind(t,94239))},66656:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},68630:(e,s,t)=>{"use strict";t.d(s,{dj:()=>x});var r=t(97451);let a=0,i=new Map,l=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},n=[],c={toasts:[]};function d(e){c=((e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}})(c,e),n.forEach(e=>{e(c)})}function o(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function x(){let[e,s]=r.useState(c);return r.useEffect(()=>(n.push(s),()=>{let e=n.indexOf(s);e>-1&&n.splice(e,1)}),[e]),{...e,toast:o,dismiss:e=>d(e?{type:"DISMISS_TOAST",toastId:e}:{type:"DISMISS_TOAST"})}}},71428:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},77066:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},80988:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},82596:(e,s,t)=>{"use strict";t.d(s,{Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>n});var r=t(11291),a=t(97451),i=t(93293);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("rounded-3xl border border-white/20 bg-white/70 text-card-foreground shadow-xl backdrop-blur-xl transition-colors",t),...a})});l.displayName="Card";let n=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 px-6 py-5",t),...a})});n.displayName="CardHeader";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});c.displayName="CardTitle",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("px-6 pb-6 pt-0 text-sm text-foreground/80",t),...a})});d.displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},89064:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},90718:(e,s,t)=>{"use strict";t.d(s,{$:()=>d});var r=t(11291),a=t(97451),i=t(26809),l=t(11263),n=t(93293);let c=(0,l.F)("inline-flex items-center justify-center whitespace-nowrap rounded-2xl text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-transparent",{variants:{variant:{default:"border border-white/30 bg-white/70 text-foreground shadow-sm backdrop-blur-xl hover:bg-white/90 focus-visible:ring-primary/40 focus-visible:ring-offset-transparent",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/90 focus-visible:ring-destructive/40 focus-visible:ring-offset-transparent",outline:"border border-white/30 bg-transparent text-foreground/80 hover:bg-white/10 focus-visible:ring-primary/30 focus-visible:ring-offset-transparent",secondary:"border border-transparent bg-primary text-primary-foreground shadow-lg hover:bg-primary/90 focus-visible:ring-primary/40 focus-visible:ring-offset-transparent",ghost:"border border-transparent bg-transparent text-foreground/70 hover:bg-white/10",link:"text-primary underline-offset-4 hover:underline hover:text-primary/80"},size:{default:"h-10 px-5",sm:"h-9 rounded-xl px-3.5",lg:"h-12 rounded-2xl px-8 text-base",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,s)=>{let{className:t,variant:a,size:l,asChild:d=!1,...o}=e,x=d?i.DX:"button";return(0,r.jsx)(x,{className:(0,n.cn)(c({variant:a,size:l,className:t})),ref:s,...o})});d.displayName="Button"},93293:(e,s,t)=>{"use strict";t.d(s,{IM:()=>h,Yq:()=>d,cn:()=>n,fw:()=>u,kz:()=>o,m7:()=>f,nr:()=>m,qA:()=>g,r6:()=>x,v7:()=>p,vv:()=>c});var r=t(41111),a=t(98358);function i(e){return null!=e?e:""}function l(e){if(!e)return new Date("Invalid Date");let s="string"==typeof e?new Date(e):e;return isNaN(s.getTime())?new Date("Invalid Date"):s}function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.QP)((0,r.$)(s))}function c(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(e)}function d(e){let s=l(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"long",day:"numeric"}).format(s)}function o(e){let s=l(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit"}).format(s)}function x(e){let s=l(null!=e?e:null);return isNaN(s.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(s)}function u(e){let s=l(null!=e?e:null);if(isNaN(s.getTime()))return"Fecha inv\xe1lida";let t=(Date.now()-s.getTime())/1e3;return t<60?"hace unos segundos":t<3600?"hace ".concat(Math.floor(t/60)," minutos"):t<86400?"hace ".concat(Math.floor(t/3600)," horas"):t<2592e3?"hace ".concat(Math.floor(t/86400)," d\xedas"):t<31104e3?"hace ".concat(Math.floor(t/2592e3)," meses"):"hace ".concat(Math.floor(t/31104e3)," a\xf1os")}function m(e){let s=i(e).replace(/[^0-9kK]/g,"");if(s.length<8)return s;let t=s.slice(0,-1),r=s.slice(-1),a=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return"".concat(a,"-").concat(r)}function h(e){let s=i(e).trim();return s?s.split(/\s+/).map(e=>e[0]).join("").toUpperCase().slice(0,2):""}function f(e){let s=l(null!=e?e:null);if(isNaN(s.getTime()))return!1;let t=new Date;t.setHours(0,0,0,0);let r=new Date(s);return r.setHours(0,0,0,0),r<t}function p(e){let s="number"!=typeof e||isNaN(e)?0:e;if(s<=0)return"0 Bytes";let t=["Bytes","KB","MB","GB"],r=Math.min(Math.floor(Math.log(s)/Math.log(1024)),t.length-1),a=(s/Math.pow(1024,r)).toFixed(2);return"".concat(a," ").concat(t[r])}function g(e){let s=i(e),t=0;for(let e=0;e<s.length;e++)t=s.charCodeAt(e)+((t<<5)-t);let r=(t%360+360)%360;return"hsl(".concat(r,", 70%, 50%)")}},94239:(e,s,t)=>{"use strict";t.d(s,{SecurityDashboard:()=>H});var r=t(11291),a=t(97451),i=t(82596),l=t(9983),n=t(90718),c=t(68630),d=t(59030);let o=(0,d.createServerReference)("407f745976e42d2d7157e4e200ed6c507c7e0a3584",d.callServer,void 0,d.findSourceMapURL,"getAuditLogs"),x=(0,d.createServerReference)("002056a0f591b373e5e9270a5a31f8d168bef8fc32",d.callServer,void 0,d.findSourceMapURL,"getSecurityAlerts"),u=(0,d.createServerReference)("40a4083fe4d4843b64ab003dffa4283cced79bd05a",d.callServer,void 0,d.findSourceMapURL,"getUserSessions"),m=(0,d.createServerReference)("403031284c5f9b8e5875c10a1c5d8cd8630bd6bb2f",d.callServer,void 0,d.findSourceMapURL,"getLoginAttempts"),h=(0,d.createServerReference)("40dfc2f25cc693a1faf1440fcb8c4a5fc6afc44cfb",d.callServer,void 0,d.findSourceMapURL,"getAuditStats"),f=(0,d.createServerReference)("40dd72fed9f1738e3d4a072a98e5b9e06ac70566e6",d.callServer,void 0,d.findSourceMapURL,"endUserSession"),p=(0,d.createServerReference)("40909f213ad7fef884907525c6dd37eead882b80e7",d.callServer,void 0,d.findSourceMapURL,"cleanupOldLogs");var g=t(93293),j=t(92608);let y=(0,j.A)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),v=(0,j.A)("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),b=(0,j.A)("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);var N=t(71428),w=t(5294),A=t(80988),S=t(89064),_=t(77066),k=t(23403);let E=(0,j.A)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),M=(0,j.A)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var R=t(11762),T=t(26181);let C=(0,j.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var L=t(94724),Z=t(66656),D=t(55448),I=t(13245),U=t(49716),B=t(11103),O=t(49043),W=t(90964),F=t(44910),z=t(83229),P=t(84178),q=t(21410);let V=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"];function H(e){let{canManage:s=!1}=e,[t,d]=(0,a.useState)("overview"),[j,H]=(0,a.useState)([]),[K,$]=(0,a.useState)([]),[G,X]=(0,a.useState)([]),[Q,Y]=(0,a.useState)([]),[J,ee]=(0,a.useState)(null),[es,et]=(0,a.useState)(!0),[er,ea]=(0,a.useState)("week"),[ei]=(0,a.useState)({table_name:"",action:"",severity:"",start_date:"",end_date:""}),{toast:el}=(0,c.dj)(),en=async()=>{et(!0);try{var e,s,t,r;let[a,i,l,n,c]=await Promise.all([o({...ei,limit:50}),x(),u(),m({limit:50}),h(er)]);(null==a?void 0:a.success)&&H(null!=(e=a.logs)?e:[]),(null==i?void 0:i.success)&&$(null!=(s=i.alerts)?s:[]),(null==l?void 0:l.success)&&X(null!=(t=l.sessions)?t:[]),(null==n?void 0:n.success)&&Y(null!=(r=n.attempts)?r:[]),(null==c?void 0:c.success)&&ee(c.stats)}catch(e){console.error("Error loading security data:",e),el({title:"Error",description:"Error al cargar datos de seguridad",variant:"destructive"})}finally{et(!1)}};(0,a.useEffect)(()=>{s&&en()},[s,er]);let ec=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres terminar esta sesi\xf3n?"))try{let s=await f(e);s.success?(el({title:"Sesi\xf3n terminada",description:"La sesi\xf3n ha sido terminada exitosamente"}),await en()):el({title:"Error",description:s.error||"Error al terminar sesi\xf3n",variant:"destructive"})}catch(e){el({title:"Error",description:"Error inesperado al terminar sesi\xf3n",variant:"destructive"})}},ed=async()=>{if(confirm("\xbfEst\xe1s seguro de que quieres limpiar los logs antiguos? Esta acci\xf3n no se puede deshacer."))try{let e=await p();e.success?(el({title:"Limpieza completada",description:"Los logs antiguos han sido eliminados"}),await en()):el({title:"Error",description:e.error||"Error al limpiar logs",variant:"destructive"})}catch(e){el({title:"Error",description:"Error inesperado al limpiar logs",variant:"destructive"})}},eo=e=>{let s=(null!=e?e:"info").toLowerCase(),t={low:"bg-gray-100 text-gray-800",info:"bg-blue-100 text-blue-800",warning:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},a=s.charAt(0).toUpperCase()+s.slice(1);return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(t[s]||t.info),children:a})};if(!s)return(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(_.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Sin permisos para acceder al panel de seguridad"})]})})});if(es)return(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(_.A,{className:"h-5 w-5"}),"Panel de Seguridad"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(k.A,{className:"h-6 w-6 animate-spin"})})})]});let ex=[{id:"overview",label:"Resumen",icon:E},{id:"audit",label:"Auditor\xeda",icon:w.A},{id:"sessions",label:"Sesiones",icon:M},{id:"alerts",label:"Alertas",icon:R.A},{id:"logins",label:"Accesos",icon:T.A}];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(_.A,{className:"h-6 w-6"}),"Panel de Seguridad"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Monitoreo y auditor\xeda del sistema"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(n.$,{size:"sm",variant:"outline",onClick:en,children:[(0,r.jsx)(C,{className:"h-4 w-4 mr-2"}),"Actualizar"]}),(0,r.jsxs)(n.$,{size:"sm",variant:"outline",onClick:ed,children:[(0,r.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Limpiar Logs"]})]})]}),K.filter(e=>"critical"===e.severity||"high"===e.severity).length>0&&(0,r.jsxs)(i.Zp,{className:"border-red-200 bg-red-50",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2 text-red-700",children:[(0,r.jsx)(R.A,{className:"h-5 w-5"}),"Alertas de Seguridad Cr\xedticas"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-2",children:K.filter(e=>"critical"===e.severity||"high"===e.severity).slice(0,3).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-red-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-red-900",children:e.description}),(0,r.jsxs)("p",{className:"text-sm text-red-700",children:[e.user_email?"Usuario: ".concat(e.user_email," • "):"","Eventos: ",e.event_count," • \xdaltimo: ",(0,g.fw)(e.last_seen)]})]}),eo(e.severity)]},s))})})]}),(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsx)("nav",{className:"-mb-px flex space-x-8",children:ex.map(e=>{let s=e.icon;return(0,r.jsxs)("button",{onClick:()=>d(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(t===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,r.jsx)(s,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.label})]},e.id)})})}),(0,r.jsxs)("div",{children:["overview"===t&&J&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Eventos de Auditor\xeda"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:J.total_events}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["\xdaltimos ","day"===er?"1 d\xeda":"week"===er?"7 d\xedas":"30 d\xedas"]})]}),(0,r.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(w.A,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Sesiones Activas"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:G.length}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Usuarios conectados"})]}),(0,r.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(M,{className:"h-6 w-6 text-green-600"})})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Alertas de Seguridad"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:K.length}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[K.filter(e=>"high"===e.severity||"critical"===e.severity).length," ","cr\xedticas"]})]}),(0,r.jsx)("div",{className:"h-12 w-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(R.A,{className:"h-6 w-6 text-orange-600"})})]})})}),(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Intentos de Login"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:Q.length}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[Q.filter(e=>!e.success).length," fallidos"]})]}),(0,r.jsx)("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(T.A,{className:"h-6 w-6 text-purple-600"})})]})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Eventos por Acci\xf3n"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)(D.u,{width:"100%",height:300,children:(0,r.jsxs)(I.r,{children:[(0,r.jsx)(U.F,{data:Object.entries(J.by_action).map(e=>{let[s,t]=e;return{action:s,count:t}}),cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{action:s,count:t}=e;return"".concat(s," (").concat(t,")")},outerRadius:80,fill:"#8884d8",dataKey:"count",children:Object.entries(J.by_action).map((e,s)=>(0,r.jsx)(B.f,{fill:V[s%V.length]},"cell-".concat(s)))}),(0,r.jsx)(O.m,{})]})})})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Timeline de Actividad"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)(D.u,{width:"100%",height:300,children:(0,r.jsxs)(W.b,{data:J.timeline,children:[(0,r.jsx)(F.d,{strokeDasharray:"3 3"}),(0,r.jsx)(z.W,{dataKey:"date"}),(0,r.jsx)(P.h,{}),(0,r.jsx)(O.m,{}),(0,r.jsx)(q.N,{type:"monotone",dataKey:"count",stroke:"#3B82F6",strokeWidth:2})]})})})]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Usuarios M\xe1s Activos"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-3",children:J.by_user.slice(0,5).map((e,s)=>{var t;let a=null!=(t=e.user_email)?t:"";return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"h-8 w-8 rounded-full flex items-center justify-center text-white font-medium text-sm",style:{backgroundColor:(0,g.qA)(a)},children:(0,g.IM)(a||"Usuario")}),(0,r.jsx)("span",{className:"font-medium",children:a||"Usuario"})]}),(0,r.jsxs)(l.E,{variant:"outline",children:[e.count," eventos"]})]},s)})})})]})]}),"audit"===t&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Logs de Auditor\xeda"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-4",children:j.map(e=>{var s,t,a,n,c;return(0,r.jsx)(i.Zp,{className:"border-l-4 border-l-blue-500",children:(0,r.jsxs)(i.Wu,{className:"pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch((null!=e?e:"").toUpperCase()){case"INSERT":return(0,r.jsx)(N.A,{className:"h-4 w-4 text-green-600"});case"UPDATE":return(0,r.jsx)(w.A,{className:"h-4 w-4 text-blue-600"});case"DELETE":return(0,r.jsx)(A.A,{className:"h-4 w-4 text-red-600"});case"SELECT":return(0,r.jsx)(S.A,{className:"h-4 w-4 text-gray-600"});default:return(0,r.jsx)(w.A,{className:"h-4 w-4 text-gray-600"})}})(e.action),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-900",children:[(null!=(s=e.action)?s:"").toUpperCase()," en ",null!=(t=e.table_name)?t:"—"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description||"Registro ".concat(null!=(a=e.record_id)?a:"—")}),e.user_email&&(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Por: ",e.user_email]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[eo(e.severity),(0,r.jsx)(l.E,{variant:"outline",children:(null!=(n=e.action)?n:"").toUpperCase()})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{children:(0,g.fw)(e.created_at)}),e.ip_address&&(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Z.A,{className:"h-3 w-3 mr-1"}),e.ip_address]})]}),(0,r.jsx)("span",{children:null!=(c=e.category)?c:"—"})]}),Array.isArray(e.changed_fields)&&e.changed_fields.length>0&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Campos modificados:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:e.changed_fields.map((e,s)=>(0,r.jsx)(l.E,{variant:"outline",className:"text-xs",children:e},s))})]})]})},e.id)})})})]}),"sessions"===t&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{children:["Sesiones Activas (",G.length,")"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[G.map(e=>{var s,t,a,c;return(0,r.jsx)(i.Zp,{className:"border-l-4 border-l-green-500",children:(0,r.jsxs)(i.Wu,{className:"pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch((null!=e?e:"desktop").toLowerCase()){case"mobile":return(0,r.jsx)(y,{className:"h-4 w-4"});case"tablet":return(0,r.jsx)(v,{className:"h-4 w-4"});default:return(0,r.jsx)(b,{className:"h-4 w-4"})}})(e.device_type),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-900",children:[null!=(s=e.browser)?s:"Navegador desconocido"," en ",null!=(t=e.os)?t:"SO desconocido"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[null!=(a=e.device_type)?a:"desktop"," • ",null!=(c=e.ip_address)?c:"—"]}),e.location_city&&e.location_country?(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.location_city,", ",e.location_country]}):null]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.E,{className:"bg-green-100 text-green-800",children:"Activa"}),(0,r.jsx)(n.$,{size:"sm",variant:"outline",onClick:()=>ec(e.id),children:"Terminar"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{children:["Iniciada: ",(0,g.fw)(e.created_at)]}),(0,r.jsxs)("span",{children:["\xdaltima actividad: ",(0,g.fw)(e.last_activity)]})]}),(0,r.jsxs)("span",{children:["Expira: ",(0,g.r6)(e.expires_at)]})]})]})},e.id)}),0===G.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(M,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{children:"No hay sesiones activas"})]})]})})]}),"alerts"===t&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{children:["Alertas de Seguridad (",K.length,")"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[K.map((e,s)=>(0,r.jsx)(i.Zp,{className:"border-l-4 ".concat("critical"===e.severity?"border-l-red-500":"high"===e.severity?"border-l-orange-500":"warning"===e.severity?"border-l-yellow-500":"border-l-blue-500"),children:(0,r.jsxs)(i.Wu,{className:"pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.description}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[e.user_email?"Usuario: ".concat(e.user_email):"",e.user_email&&e.ip_address?" • ":"",e.ip_address?"IP: ".concat(e.ip_address):""]})]}),eo(e.severity)]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{children:["Eventos: ",e.event_count]}),(0,r.jsxs)("span",{children:["Primer evento: ",(0,g.fw)(e.first_seen)]})]}),(0,r.jsxs)("span",{children:["\xdaltimo: ",(0,g.fw)(e.last_seen)]})]})]})},s)),0===K.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(N.A,{className:"h-12 w-12 mx-auto mb-4 text-green-300"}),(0,r.jsx)("p",{children:"No hay alertas de seguridad"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"El sistema est\xe1 funcionando normalmente"})]})]})})]}),"logins"===t&&(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Intentos de Login Recientes"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[Q.map(e=>(0,r.jsx)(i.Zp,{className:"border-l-4 ".concat(e.success?"border-l-green-500":"border-l-red-500"),children:(0,r.jsxs)(i.Wu,{className:"pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[e.success?(0,r.jsx)(N.A,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(A.A,{className:"h-5 w-5 text-red-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.email}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["IP: ",e.ip_address]}),!e.success&&e.failure_reason&&(0,r.jsxs)("p",{className:"text-sm text-red-600",children:["Raz\xf3n: ",e.failure_reason]})]})]}),(0,r.jsx)(l.E,{variant:e.success?"default":"destructive",children:e.success?"Exitoso":"Fallido"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,r.jsx)("span",{children:(0,g.fw)(e.created_at)}),e.user_agent&&(0,r.jsx)("span",{className:"truncate max-w-md",children:e.user_agent})]})]})},e.id)),0===Q.length&&(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(T.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{children:"No hay intentos de login recientes"})]})]})})]})]})]})}},94724:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(92608).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},e=>{e.O(0,[936,582,193,55,358],()=>e(e.s=62261)),_N_E=e.O()}]);