(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{23403:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(92608).A)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},23838:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});var a=r(97451),s=r(31010),l=r(11291),n=a.forwardRef((e,t)=>(0,l.jsx)(s.sG.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var i=n},26181:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(92608).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},28598:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var a=r(59030);let s=(0,a.createServerReference)("406bc1e57d930aa66be0c359227cb415ca860d3043",a.callServer,void 0,a.findSourceMapURL,"createClientProfile")},31010:(e,t,r)=>{"use strict";r.d(t,{hO:()=>o,sG:()=>i});var a=r(97451),s=r(8970),l=r(26809),n=r(11291),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,l.TL)(`Primitive.${t}`),s=a.forwardRef((e,a)=>{let{asChild:s,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(s?r:t,{...l,ref:a})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function o(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},36588:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(11291),s=r(97451),l=r(59030);let n=(0,l.createServerReference)("40369dae68d0dde1075e4502ae8e83ff3fd5677003",l.callServer,void 0,l.findSourceMapURL,"listClients");var i=r(28598),o=r(82596),c=r(90718),d=r(40918),u=r(73244),f=r(68630),m=r(93293),p=r(26181),h=r(23403);let x=(0,r(92608).A)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function g(){let[e,t]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[g,b]=(0,s.useState)(!1),[v,y]=(0,s.useState)(""),[w,N]=(0,s.useState)({nombre:"",email:"",rut:"",telefono:""}),{toast:j}=(0,f.dj)(),S=(0,s.useCallback)(async e=>{l(!0);try{let r=await n(e?{search:e}:{});r.success?t(r.clients):j({title:"No se pudieron cargar los clientes",description:r.error,variant:"destructive"})}catch(e){console.error("Error loading clients directory",e),j({title:"Error inesperado",description:"No fue posible obtener la lista de clientes.",variant:"destructive"})}finally{l(!1)}},[j]);(0,s.useEffect)(()=>{S()},[S]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{S(v.trim()?v:void 0)},350);return()=>clearTimeout(e)},[v,S]);let T=e=>t=>{let r="rut"===e?(0,m.nr)(t.target.value):t.target.value;N(t=>({...t,[e]:r}))},C=async e=>{e.preventDefault(),b(!0);try{let e={nombre:w.nombre.trim(),email:w.email.trim(),rut:w.rut.trim()||void 0,telefono:w.telefono.trim()||void 0},s=await (0,i.B)(e);if(s.success){var r,a;j({title:"Cliente creado",description:"".concat(s.client.nombre," fue a\xf1adido al directorio.")});let e={id:s.client.id,nombre:s.client.nombre,email:s.client.email,telefono:null!=(r=s.client.telefono)?r:null,rut:null!=(a=s.client.rut)?a:null,created_at:new Date().toISOString()};t(t=>[...t,e].sort((e,t)=>e.nombre.localeCompare(t.nombre,"es"))),N({nombre:"",email:"",rut:"",telefono:""})}else j({title:"No se pudo crear el cliente",description:s.error,variant:"destructive"})}catch(e){console.error("Error creating client",e),j({title:"Error inesperado",description:"No fue posible crear el cliente, intenta nuevamente.",variant:"destructive"})}finally{b(!1)}},M=(0,s.useMemo)(()=>e.length,[e]);return(0,a.jsxs)("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-8 px-4 py-10 sm:px-6 lg:px-8",children:[(0,a.jsx)("header",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-50 text-blue-600",children:(0,a.jsx)(p.A,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"Directorio de clientes"}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Crea y gestiona clientes antes de asociarles casos o planes legales."})]})]})}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.1fr_1.9fr]",children:[(0,a.jsxs)(o.Zp,{className:"border-slate-200 bg-white/90 backdrop-blur",children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{className:"text-lg font-semibold text-slate-900",children:"Registrar nuevo cliente"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:C,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"nombre",children:"Nombre completo"}),(0,a.jsx)(d.p,{id:"nombre",value:w.nombre,onChange:T("nombre"),placeholder:"Ej: Carla Gonz\xe1lez",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"email",children:"Correo electr\xf3nico"}),(0,a.jsx)(d.p,{id:"email",type:"email",value:w.email,onChange:T("email"),placeholder:"cliente@correo.cl",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"rut",children:"RUT"}),(0,a.jsx)(d.p,{id:"rut",value:w.rut,onChange:T("rut"),placeholder:"12.345.678-9"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{htmlFor:"telefono",children:"Tel\xe9fono"}),(0,a.jsx)(d.p,{id:"telefono",value:w.telefono,onChange:T("telefono"),placeholder:"+56 9 1234 5678"})]})]}),(0,a.jsx)(c.$,{type:"submit",className:"flex items-center gap-2",disabled:g,children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}),"Creando…"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{className:"h-4 w-4"}),"Guardar cliente"]})})]})})]}),(0,a.jsxs)(o.Zp,{className:"border-slate-200 bg-white/90 backdrop-blur",children:[(0,a.jsxs)(o.aR,{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(o.ZB,{className:"text-lg font-semibold text-slate-900",children:["Clientes registrados (",M,")"]}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Filtra por nombre, correo o RUT para encontrar un cliente existente."})]}),(0,a.jsx)("div",{className:"w-full sm:w-64",children:(0,a.jsx)(d.p,{value:v,onChange:e=>y(e.target.value),placeholder:"Buscar cliente…"})})]}),(0,a.jsx)(o.Wu,{className:"space-y-3",children:r?(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-xl border border-slate-200 bg-white/70 px-4 py-3 text-sm text-slate-500",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 animate-spin"}),"Cargando clientes…"]}):0===e.length?(0,a.jsx)("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50 px-4 py-6 text-center text-sm text-slate-500",children:"No hay clientes registrados todav\xeda. Crea el primero para comenzar."}):(0,a.jsx)("ul",{className:"space-y-3",children:e.map(e=>(0,a.jsxs)("li",{className:"flex flex-col gap-2 rounded-xl border border-slate-200 bg-white/80 px-4 py-3 text-sm text-slate-700 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-between gap-2 sm:flex-row sm:items-center",children:[(0,a.jsx)("p",{className:"text-base font-medium text-slate-900",children:e.nombre}),e.created_at&&(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:["Creado el ",new Date(e.created_at).toLocaleDateString("es-CL")]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-x-6 gap-y-1 text-xs text-slate-500",children:[(0,a.jsx)("span",{children:e.email}),e.telefono&&(0,a.jsxs)("span",{children:["Tel: ",e.telefono]}),e.rut&&(0,a.jsxs)("span",{children:["RUT: ",e.rut]})]})]},e.id))})})]})]})]})}},40918:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(11291),s=r(97451),l=r(93293);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-11 w-full rounded-2xl border border-white/30 bg-white/70 px-4 text-sm text-foreground/80 shadow-inner ring-offset-transparent transition-all placeholder:text-foreground/40 focus-visible:border-primary focus-visible:bg-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30 disabled:cursor-not-allowed disabled:opacity-60",r),ref:t,...n})});n.displayName="Input"},59030:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return s.findSourceMapURL}});let a=r(87233),s=r(89721),l=r(54661)},68630:(e,t,r)=>{"use strict";r.d(t,{dj:()=>u});var a=r(97451);let s=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=[],o={toasts:[]};function c(e){o=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(o,e),i.forEach(e=>{e(o)})}function d(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function u(){let[e,t]=a.useState(o);return a.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c(e?{type:"DISMISS_TOAST",toastId:e}:{type:"DISMISS_TOAST"})}}},73244:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var a=r(11291),s=r(97451),l=r(23838),n=r(11263),i=r(93293);let o=(0,n.F)("text-sm font-medium leading-none text-foreground/75 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.b,{ref:t,className:(0,i.cn)(o(),r),...s})});c.displayName=l.b.displayName},78159:(e,t,r)=>{Promise.resolve().then(r.bind(r,36588))},82596:(e,t,r)=>{"use strict";r.d(t,{Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>i});var a=r(11291),s=r(97451),l=r(93293);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-3xl border border-white/20 bg-white/70 text-card-foreground shadow-xl backdrop-blur-xl transition-colors",r),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 px-6 py-5",r),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});o.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("px-6 pb-6 pt-0 text-sm text-foreground/80",r),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},90718:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var a=r(11291),s=r(97451),l=r(26809),n=r(11263),i=r(93293);let o=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-2xl text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-transparent",{variants:{variant:{default:"border border-white/30 bg-white/70 text-foreground shadow-sm backdrop-blur-xl hover:bg-white/90 focus-visible:ring-primary/40 focus-visible:ring-offset-transparent",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/90 focus-visible:ring-destructive/40 focus-visible:ring-offset-transparent",outline:"border border-white/30 bg-transparent text-foreground/80 hover:bg-white/10 focus-visible:ring-primary/30 focus-visible:ring-offset-transparent",secondary:"border border-transparent bg-primary text-primary-foreground shadow-lg hover:bg-primary/90 focus-visible:ring-primary/40 focus-visible:ring-offset-transparent",ghost:"border border-transparent bg-transparent text-foreground/70 hover:bg-white/10",link:"text-primary underline-offset-4 hover:underline hover:text-primary/80"},size:{default:"h-10 px-5",sm:"h-9 rounded-xl px-3.5",lg:"h-12 rounded-2xl px-8 text-base",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(o({variant:s,size:n,className:r})),ref:t,...d})});c.displayName="Button"},92608:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(97451),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:d="",children:u,...f}=r;return(0,a.createElement)("svg",{ref:l,...s,width:i,height:i,stroke:n,strokeWidth:c?24*Number(o)/Number(i):o,className:["lucide","lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()),d].join(" "),...f},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])});return r.displayName="".concat(e),r}},93293:(e,t,r)=>{"use strict";r.d(t,{IM:()=>p,Yq:()=>c,cn:()=>i,fw:()=>f,kz:()=>d,m7:()=>h,nr:()=>m,qA:()=>g,r6:()=>u,v7:()=>x,vv:()=>o});var a=r(41111),s=r(98358);function l(e){return null!=e?e:""}function n(e){if(!e)return new Date("Invalid Date");let t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?new Date("Invalid Date"):t}function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}function o(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(e)}function c(e){let t=n(null!=e?e:null);return isNaN(t.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"long",day:"numeric"}).format(t)}function d(e){let t=n(null!=e?e:null);return isNaN(t.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)}function u(e){let t=n(null!=e?e:null);return isNaN(t.getTime())?"":new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)}function f(e){let t=n(null!=e?e:null);if(isNaN(t.getTime()))return"Fecha inv\xe1lida";let r=(Date.now()-t.getTime())/1e3;return r<60?"hace unos segundos":r<3600?"hace ".concat(Math.floor(r/60)," minutos"):r<86400?"hace ".concat(Math.floor(r/3600)," horas"):r<2592e3?"hace ".concat(Math.floor(r/86400)," d\xedas"):r<31104e3?"hace ".concat(Math.floor(r/2592e3)," meses"):"hace ".concat(Math.floor(r/31104e3)," a\xf1os")}function m(e){let t=l(e).replace(/[^0-9kK]/g,"");if(t.length<8)return t;let r=t.slice(0,-1),a=t.slice(-1),s=r.replace(/\B(?=(\d{3})+(?!\d))/g,".");return"".concat(s,"-").concat(a)}function p(e){let t=l(e).trim();return t?t.split(/\s+/).map(e=>e[0]).join("").toUpperCase().slice(0,2):""}function h(e){let t=n(null!=e?e:null);if(isNaN(t.getTime()))return!1;let r=new Date;r.setHours(0,0,0,0);let a=new Date(t);return a.setHours(0,0,0,0),a<r}function x(e){let t="number"!=typeof e||isNaN(e)?0:e;if(t<=0)return"0 Bytes";let r=["Bytes","KB","MB","GB"],a=Math.min(Math.floor(Math.log(t)/Math.log(1024)),r.length-1),s=(t/Math.pow(1024,a)).toFixed(2);return"".concat(s," ").concat(r[a])}function g(e){let t=l(e),r=0;for(let e=0;e<t.length;e++)r=t.charCodeAt(e)+((r<<5)-r);let a=(r%360+360)%360;return"hsl(".concat(a,", 70%, 50%)")}}},e=>{e.O(0,[936,193,55,358],()=>e(e.s=78159)),_N_E=e.O()}]);